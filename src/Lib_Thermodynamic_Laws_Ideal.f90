module Lib_Thermodynamic_Laws_Ideal
!-----------------------------------------------------------------------------------------------------------------------------------
!!The module Lib_Thermodynamic_Laws_Ideal contains Thermodynamic Laws for ideal calorically perfect gas.
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
USE IR_Precision ! Definition of integers and reals precision.
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
implicit none
private
public:: p
public:: r
public:: a
public:: E
public:: H
!-----------------------------------------------------------------------------------------------------------------------------------
contains
  elemental function p(r,a,g) result(pressure)
  !---------------------------------------------------------------------------------------------------------------------------------
  ! This function computes the pressure for an ideal calorically perfect gas.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  implicit none
  real(R_P), intent(IN):: r        ! Density.
  real(R_P), intent(IN):: a        ! Speed of sound.
  real(R_P), intent(IN):: g        ! Specific heats ratio $\frac{{c_p}}{{c_v}}$.
  real(R_P)               pressure ! Pressure.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  pressure = r*a*a/g
  return
  !---------------------------------------------------------------------------------------------------------------------------------
  endfunction p

  elemental function r(p,a,g) result(density)
  !---------------------------------------------------------------------------------------------------------------------------------
  ! This function computes the density for an ideal calorically perfect gas.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  implicit none
  real(R_P), intent(IN):: p       ! Pressure.
  real(R_P), intent(IN):: a       ! Speed of sound.
  real(R_P), intent(IN):: g       ! Specific heats ratio $\frac{{c_p}}{{c_v}}$.
  real(R_P)               density ! Density.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  density = g*p/(a*a)
  return
  !---------------------------------------------------------------------------------------------------------------------------------
  endfunction r

  elemental function a(p,r,g) result(ss)
  !---------------------------------------------------------------------------------------------------------------------------------
  ! This function computes the speed of sound for an ideal calorically perfect gas.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  implicit none
  real(R_P), intent(IN):: p  ! Pressure.
  real(R_P), intent(IN):: r  ! Density.
  real(R_P), intent(IN):: g  ! Specific heats ratio $\frac{{c_p}}{{c_v}}$.
  real(R_P)               ss ! Speed of sound.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  ss = sqrt(g*p/r)
  return
  !---------------------------------------------------------------------------------------------------------------------------------
  endfunction a

  elemental function E(p,r,u,g) result(energy)
  !---------------------------------------------------------------------------------------------------------------------------------
  !!This function computes total specific energy (per unit of mass).
  !!\begin{equation}
  !!  E = \frac{p}{{\left( {\g  - 1} \right)\r }} + \frac{{u^2 }}{2}
  !!\end{equation}
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  implicit none
  real(R_P), intent(IN):: p      ! Pressure.
  real(R_P), intent(IN):: r      ! Density.
  real(R_P), intent(IN):: u      ! Module of velocity vector.
  real(R_P), intent(IN):: g      ! Specific heats ratio $\frac{{c_p}}{{c_v}}$.
  real(R_P)               energy ! Total specific energy (per unit of mass).
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  energy = p/((g-1._R_P)*r)+0.5_R_P*u*u
  return
  !---------------------------------------------------------------------------------------------------------------------------------
  endfunction E

  elemental function H(p,r,u,g) result(entalpy)
  !---------------------------------------------------------------------------------------------------------------------------------
  !!This function computes total specific entalpy (per unit of mass).
  !!\begin{equation}
  !!  H = \frac{{\g p}}{{\left( {\g  - 1} \right)\r }} + \frac{{u^2 }}{2}
  !!\end{equation}
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  implicit none
  real(R_P), intent(IN):: g       ! Specific heats ratio $\frac{{c_p}}{{c_v}}$.
  real(R_P), intent(IN):: p       ! Pressure.
  real(R_P), intent(IN):: r       ! Density.
  real(R_P), intent(IN):: u       ! Module of velocity vector.
  real(R_P)               entalpy ! Total specific entalpy (per unit of mass).
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  entalpy = g*p/((g-1._R_P)*r)+0.5_R_P*u*u
  return
  !---------------------------------------------------------------------------------------------------------------------------------
  endfunction H
endmodule Lib_Thermodynamic_Laws_Ideal
